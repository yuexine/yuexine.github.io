{"pages":[],"posts":[{"title":"Hello World","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post$ hexo new &quot;My New Post&quot; More info: Writing Run server$ hexo server More info: Server Generate static files$ hexo generate More info: Generating Deploy to remote sites$ hexo deploy More info: Deployment","link":"/2019/04/24/hello-world/"},{"title":"test_my_site","text":"","link":"/2019/04/24/test-my-site/"},{"title":"Jenkins集成Helm进行应用持续发布","text":"目标 在开发过程中，对开发的应用版本进行持续迭代并且发布到kubernetes集群中 使用Helm工具以chart升级的方式完成不同版本应用的发布升级 前提 在使用Helm之前，已经完成了Jenkins的部署，并且已经正常运行脚本与Kubernetes平台进行 通过kubectl命令执行配置文件完成应用的版本更新 实现步骤 helm chart制作，此步骤略 包含helm工具的jenkins容器镜像制作 制作完成的镜像文件 harbor.3incloud.com/library/jenkins-jnlp:latest 初始化应用安装 helm init --client-only &amp;&amp; helm repo add --username jenkins --password password myharbor https://harbor.3incloud.com/chartrepo/avic &amp;&amp; helm repo update 这里主要就是在slave中初始化helm，并且添加私有的chart仓库 Jenkins完成应用持续部署 helm upgrade --reuse-values --set-string image.tag='${build_tag}' deploy-name --version 0.1.0 myharbor/chart-name 通过重新设定chart的image.tag完成容器的版本升级，--reuse-values 表示在原本参数的基础上进行更新 完整的Pipeline脚本node('worker') { stage('Clone') { echo &quot;1.Clone Stage&quot; git credentialsId: 'gitlab-auth', url: 'https://gitlab.3incloud.com/xxx/xxx-server.git' script { build_tag = sh(returnStdout: true, script: 'git rev-parse --short HEAD').trim() } } stage('Test') { echo &quot;2.Test Stage&quot; } stage('Build') { echo &quot;3.Build Docker Image Stage&quot; sh &quot;docker build -t harbor.3incloud.com/xxx/xxx-server:${build_tag} .&quot; } stage('Push') { echo &quot;4.Push Docker Image Stage&quot; withDockerRegistry(credentialsId: 'harbor-ci', url: 'https://harbor.3incloud.com') { sh &quot;docker push harbor.3incloud.com/xxx/xxx-server:${build_tag}&quot; } } stage('Deploy') { echo &quot;5. Deploy Stage&quot; sh &quot;helm init --client-only &amp;&amp; helm repo add --username jenkins --password password myharbor https://harbor.3incloud.com/chartrepo/xxx &amp;&amp; helm repo update&quot; sh &quot;helm upgrade --reuse-values --set-string image.tag='${build_tag}' avic-server --version 0.1.0 myharbor/xxx-server&quot; } }","link":"/2019/04/25/Jenkins集成Helm进行应用持续发布/"}],"tags":[{"name":"jenkins","slug":"jenkins","link":"/tags/jenkins/"},{"name":"helm","slug":"helm","link":"/tags/helm/"}],"categories":[{"name":"CI","slug":"CI","link":"/categories/CI/"}]}